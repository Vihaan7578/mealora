<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grocery List - Mealora</title>
    <link rel="stylesheet" href="dist/style.css">
</head>
<body>
    <!-- Background Orbs -->
    <div class="bg-orbs">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <img src="logo.PNG" alt="Mealora" style="height: 45px; width: auto;">
                <span>Mealora</span>
            </a>
            
            <!-- Desktop Navigation -->
            <ul class="nav-links desktop-nav">
                <li><a href="index.html">Home</a></li>
                <li><a href="planner.html">Meal Planner</a></li>
                <li><a href="grocery.html" class="active">Grocery List</a></li>
                <li><a href="saved.html">Saved Plans</a></li>
                <li><a href="progress.html">Progress</a></li>
                <li><a href="recipes.html">Recipes</a></li>
            </ul>
            
            <!-- Mobile Menu Button -->
            <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Toggle mobile menu">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
            
            <!-- Mobile Dropdown Menu -->
            <div class="mobile-menu" id="mobileMenu">
                <ul class="mobile-nav-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="planner.html">Meal Planner</a></li>
                    <li><a href="grocery.html" class="active">Grocery List</a></li>
                    <li><a href="saved.html">Saved Plans</a></li>
                    <li><a href="progress.html">Progress</a></li>
                    <li><a href="recipes.html">Recipes</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <div style="text-align: center; margin-bottom: 3rem;">
            <h1 style="font-size: 3rem; font-weight: 900; margin-bottom: 0.5rem;" class="gradient-text">
                üõí Smart Grocery List
            </h1>
            <p style="font-size: 1.25rem; color: var(--gray-600);">
                Generate your shopping list with Indian ingredients from saved meal plans
            </p>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 2rem;">
            <!-- Left Panel - Saved Plans -->
            <div class="glass" style="padding: 2rem; border-radius: 1.5rem;">
                <h2 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 1.5rem; color: var(--gray-900);">
                    Select a Meal Plan
                </h2>
                <div id="savedPlansList" style="display: flex; flex-direction: column; gap: 1rem;">
                    <!-- Plans will be loaded here -->
                </div>
            </div>

            <!-- Right Panel - Grocery List -->
            <div class="glass" style="padding: 2rem; border-radius: 1.5rem; min-height: 600px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h2 style="font-size: 1.5rem; font-weight: 700; color: var(--gray-900);">
                        Your Shopping List
                    </h2>
                    <div id="groceryActions" style="display: none; gap: 0.5rem;">
                        <button onclick="copyGroceryList()" class="btn btn-primary" style="padding: 0.75rem 1.5rem;">
                            üìã Copy List
                        </button>
                        <button onclick="printGroceryList()" class="btn btn-secondary" style="padding: 0.75rem 1.5rem;">
                            üñ®Ô∏è Print
                        </button>
                    </div>
                </div>

                <div id="groceryContent" style="text-align: center; padding: 4rem 2rem;">
                    <div style="font-size: 5rem; margin-bottom: 1.5rem;">üõí</div>
                    <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--gray-900); margin-bottom: 1rem;">
                        Select a Meal Plan
                    </h3>
                    <p style="color: var(--gray-600);">
                        Choose a saved meal plan from the left to generate your Indian grocery list
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        setActivePage('grocery.html');
        let currentGroceryList = '';

        // Load saved plans
        function loadSavedPlans() {
            const plans = getSavedPlans();
            const container = document.getElementById('savedPlansList');
            
            if (plans.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: var(--gray-600);">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">üìã</div>
                        <p>No saved plans yet!</p>
                        <p style="font-size: 0.875rem; margin-top: 0.5rem;">Create a meal plan first</p>
                        <a href="planner.html" class="btn btn-primary" style="margin-top: 1rem; display: inline-flex; text-decoration: none;">
                            Create Plan
                        </a>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = plans.map(plan => `
                <button onclick="generateGroceryListFromPlan(${plan.id})" 
                        style="padding: 1.5rem; background: white; border: 2px solid var(--gray-200); border-radius: 1rem; cursor: pointer; text-align: left; transition: all 0.2s;"
                        onmouseover="this.style.borderColor='var(--primary)'; this.style.transform='scale(1.02)';"
                        onmouseout="this.style.borderColor='var(--gray-200)'; this.style.transform='scale(1)';">
                    <div style="font-weight: 700; color: var(--gray-900); margin-bottom: 0.5rem;">üìã ${plan.name}</div>
                    <div style="font-size: 0.875rem; color: var(--gray-600);">
                        ${new Date(plan.date).toLocaleDateString()}
                    </div>
                </button>
            `).join('');
        }

        async function generateGroceryListFromPlan(planId) {
            const plans = getSavedPlans();
            const plan = plans.find(p => p.id === planId);
            
            if (!plan) return;
            
            const content = document.getElementById('groceryContent');
            content.innerHTML = `
                <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 4rem 2rem;">
                    <div class="loading-spinner" style="margin-bottom: 1.5rem;"></div>
                    <h3 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 1rem;" class="gradient-text">
                        Generating Shopping List
                    </h3>
                    <p style="color: var(--gray-600);">AI is organizing your Indian groceries...</p>
                </div>
            `;
            
            try {
                const prompt = `From this INDIAN meal plan, create a comprehensive grocery shopping list organized by Indian categories:

${plan.mealPlan}

Organize into these categories with quantities in Indian measurements (kg, grams, packets, bunches):

1. ü•¨ SABZI & VEGETABLES (Subziyan)
   - Aloo, Pyaaz, Tamatar, Bhindi, Baingan, Palak, Methi, Lauki, Tinda, Karela, Shimla mirch, etc.

2. üåæ DAL & PULSES (Daalen)
   - Toor dal, Moong dal (split/whole), Masoor dal, Chana dal, Rajma, Kabuli chana, Kala chana, Urad dal

3. üçö GRAINS & ATTA (Anaaj)
   - Wheat atta, Rice (basmati/regular), Besan, Maida, Sooji/Rava, Poha, Jowar, Bajra, Ragi

4. ü•õ DAIRY (Doodh Utpad)
   - Milk (doodh), Dahi (curd), Paneer, Ghee, Butter (makhan), Cream

5. üßÇ MASALE & SPICES
   - Haldi, Laal mirch, Dhaniya powder, Jeera, Garam masala, Hing, Rai, Methi dana, Tej patta, Dalchini, Laung, Elaichi

6. ü•´ INDIAN STAPLES (Zaruri Saman)
   - Cooking oil, Salt (namak), Sugar (chini), Gud (jaggery), Pickle (achaar), Papad, Tea/Chai patti, Coffee

7. üå∞ DRY FRUITS & NUTS (Mewa)
   - Badam, Kaju, Pista, Akhrot, Kishmish, Khajur

8. ü•ó SALAD & FRESH
   - Kheera (cucumber), Mooli, Gajar, Pudina, Dhaniya leaves, Hari mirch, Nimbu

Format with Indian terms and measurements (500g, 1 kg, 1 bunch/guccha, 1 packet, etc.).`;

                const groceryList = await generateWithAI(prompt);
                currentGroceryList = groceryList;
                
                document.getElementById('groceryActions').style.display = 'flex';
                displayGroceryList(groceryList);
                showNotification('‚úÖ Grocery list generated!', 'success');
            } catch (error) {
                content.innerHTML = `
                    <div style="text-align: center; padding: 4rem 2rem;">
                        <div style="font-size: 4rem; margin-bottom: 1rem;">‚ùå</div>
                        <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--danger); margin-bottom: 1rem;">
                            Failed to Generate List
                        </h3>
                        <p style="color: var(--gray-600);">Please try again</p>
                    </div>
                `;
                showNotification('Failed to generate grocery list', 'error');
            }
        }

        function displayGroceryList(list) {
            const content = document.getElementById('groceryContent');
            content.innerHTML = `
                <div style="max-height: 70vh; overflow-y: auto; text-align: left;">
                    <div style="background: linear-gradient(135deg, #3B82F6 0%, #1D4ED8 100%); color: white; padding: 2rem; border-radius: 1rem; text-align: center; margin-bottom: 1.5rem;">
                        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">üõí</div>
                        <h3 style="font-size: 1.5rem; font-weight: 700;">Your Weekly Shopping List</h3>
                        <p style="opacity: 0.9; margin-top: 0.5rem;">Everything you need with Indian ingredients</p>
                    </div>
                    
                    <div style="background: white; border-radius: 1rem; padding: 2rem;">
                        <pre style="white-space: pre-wrap; font-family: 'Inter', sans-serif; font-size: 0.95rem; color: var(--gray-800); line-height: 1.8;">${list}</pre>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-top: 1.5rem;">
                        <div style="background: var(--success); color: white; padding: 1.5rem; border-radius: 0.75rem; text-align: center;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">‚úÖ</div>
                            <div style="font-weight: 700;">Organized</div>
                            <div style="font-size: 0.875rem; opacity: 0.9;">By category</div>
                        </div>
                        <div style="background: var(--info); color: white; padding: 1.5rem; border-radius: 0.75rem; text-align: center;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">üìã</div>
                            <div style="font-weight: 700;">Complete</div>
                            <div style="font-size: 0.875rem; opacity: 0.9;">Full week</div>
                        </div>
                        <div style="background: var(--warning); color: white; padding: 1.5rem; border-radius: 0.75rem; text-align: center;">
                            <div style="font-size: 2rem; margin-bottom: 0.5rem;">üáÆüá≥</div>
                            <div style="font-weight: 700;">Indian</div>
                            <div style="font-size: 0.875rem; opacity: 0.9;">Desi ingredients</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function copyGroceryList() {
            navigator.clipboard.writeText(currentGroceryList);
            showNotification('üìã Copied to clipboard!', 'success');
        }

        function printGroceryList() {
            const printWindow = window.open('', '', 'height=600,width=800');
            printWindow.document.write('<html><head><title>Indian Grocery List</title>');
            printWindow.document.write('<style>body{font-family:Arial,sans-serif;padding:20px;line-height:1.6;}pre{white-space:pre-wrap;}</style>');
            printWindow.document.write('</head><body>');
            printWindow.document.write('<h1>üõí Mealora - Indian Grocery List</h1>');
            printWindow.document.write('<pre>' + currentGroceryList + '</pre>');
            printWindow.document.write('</body></html>');
            printWindow.document.close();
            printWindow.print();
        }

        // Initialize
        loadSavedPlans();
    </script>

    <!-- Footer -->
    <footer style="text-align: center; padding: 3rem 2rem; background: rgba(30, 35, 55, 0.5); border-top: 1px solid var(--border-color); margin-top: 4rem;">
        <p style="font-size: 1.25rem; margin-bottom: 0.5rem; font-weight: 700; background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
            Made for Hackathon by Team BBPS Brij Vihar üèÜ
        </p>
        <p style="color: var(--text-muted); font-size: 0.875rem;">¬© 2025 Mealora. All rights reserved.</p>
    </footer>

    <script src="app.js"></script>
    <script>
        setActivePage('grocery.html');
        
        // Responsive Navigation System
        class ResponsiveNavigation {
            constructor() {
                this.mobileMenuBtn = document.getElementById('mobileMenuBtn');
                this.mobileMenu = document.getElementById('mobileMenu');
                this.desktopNav = document.querySelector('.desktop-nav');
                this.isMenuOpen = false;
                
                this.init();
            }
            
            init() {
                this.detectDevice();
                this.setupEventListeners();
                this.setupResizeListener();
            }
            
            detectDevice() {
                const userAgent = navigator.userAgent.toLowerCase();
                const isMobile = /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent);
                const isTablet = /ipad|android(?!.*mobile)/i.test(userAgent);
                const screenWidth = window.innerWidth;
                
                const shouldShowMobileMenu = isMobile || isTablet || screenWidth < 1024;
                
                if (shouldShowMobileMenu) {
                    this.showMobileMenu();
                } else {
                    this.showDesktopMenu();
                }
            }
            
            showMobileMenu() {
                if (this.desktopNav) this.desktopNav.style.display = 'none';
                if (this.mobileMenuBtn) this.mobileMenuBtn.style.display = 'block';
                if (this.mobileMenu) this.mobileMenu.style.display = 'none';
            }
            
            showDesktopMenu() {
                if (this.desktopNav) this.desktopNav.style.display = 'flex';
                if (this.mobileMenuBtn) this.mobileMenuBtn.style.display = 'none';
                if (this.mobileMenu) this.mobileMenu.style.display = 'none';
                this.isMenuOpen = false;
            }
            
            setupEventListeners() {
                if (this.mobileMenuBtn) {
                    this.mobileMenuBtn.addEventListener('click', () => this.toggleMobileMenu());
                }
                
                const mobileLinks = document.querySelectorAll('.mobile-nav-links a');
                mobileLinks.forEach(link => {
                    link.addEventListener('click', () => {
                        this.closeMobileMenu();
                    });
                });
                
                document.addEventListener('click', (e) => {
                    if (this.isMenuOpen && 
                        !this.mobileMenu.contains(e.target) && 
                        !this.mobileMenuBtn.contains(e.target)) {
                        this.closeMobileMenu();
                    }
                });
            }
            
            setupResizeListener() {
                let resizeTimeout;
                window.addEventListener('resize', () => {
                    clearTimeout(resizeTimeout);
                    resizeTimeout = setTimeout(() => {
                        this.detectDevice();
                    }, 250);
                });
            }
            
            toggleMobileMenu() {
                if (this.isMenuOpen) {
                    this.closeMobileMenu();
                } else {
                    this.openMobileMenu();
                }
            }
            
            openMobileMenu() {
                if (this.mobileMenu) {
                    this.mobileMenu.style.display = 'block';
                    this.mobileMenu.style.opacity = '0';
                    this.mobileMenu.style.transform = 'translateY(-10px)';
                    
                    requestAnimationFrame(() => {
                        this.mobileMenu.style.transition = 'all 0.3s ease';
                        this.mobileMenu.style.opacity = '1';
                        this.mobileMenu.style.transform = 'translateY(0)';
                    });
                    
                    this.isMenuOpen = true;
                    this.mobileMenuBtn.classList.add('active');
                }
            }
            
            closeMobileMenu() {
                if (this.mobileMenu) {
                    this.mobileMenu.style.transition = 'all 0.3s ease';
                    this.mobileMenu.style.opacity = '0';
                    this.mobileMenu.style.transform = 'translateY(-10px)';
                    
                    setTimeout(() => {
                        this.mobileMenu.style.display = 'none';
                    }, 300);
                    
                    this.isMenuOpen = false;
                    this.mobileMenuBtn.classList.remove('active');
                }
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            new ResponsiveNavigation();
        });
    </script>
</body>
</html>

